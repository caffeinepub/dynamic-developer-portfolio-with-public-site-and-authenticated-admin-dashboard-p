{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Admin login: user-friendly errors and remove role/permission messaging",
  "requirements": [
    {
      "id": "REQ-43",
      "summary": "Improve Admin Login error handling to show clear, user-friendly messages on backend failures and suppress misleading role/permission assignment wording.",
      "acceptanceCriteria": [
        "If `createAdminSession` throws/traps for any reason, the Admin Login form displays a user-friendly error in the existing error alert area.",
        "Successful login continues to redirect to the intended admin destination as currently implemented.",
        "The login screen does not show backend errors referring to assigning roles/permissions (e.g., \"Only admins can assign user roles\") in normal operation with correct credentials."
      ],
      "file_operations": [
        {
          "path": "frontend/src/utils/adminAuthErrors.ts",
          "operation": "create",
          "description": "Add a small helper to normalize/sanitize admin-login errors into user-friendly messages (e.g., map Unauthorized/role/permission-assignment related backend text to a clear login failure message without referencing roles/permissions)."
        },
        {
          "path": "frontend/src/components/auth/AdminEmailLoginForm.tsx",
          "operation": "modify",
          "description": "Use the new adminAuthErrors helper to (1) display friendly errors when the backend traps/throws and (2) sanitize `CreateSessionResponse.__kind__ === 'failure'` messages so they never surface role/permission-assignment wording in the alert area."
        },
        {
          "path": "frontend/src/hooks/useAdminSession.ts",
          "operation": "modify",
          "description": "Harden the login mutation error surface for the UI by ensuring thrown/trapped errors from `createAdminSession` are propagated as a standard `Error` message suitable for user-friendly handling (paired with the sanitizer in the login form)."
        }
      ]
    }
  ]
}